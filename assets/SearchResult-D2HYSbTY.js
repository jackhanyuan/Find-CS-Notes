import{u as U,g as Z,h as ee,i as M,j as ae,k as se,t as te,l as le,m as B,n as L,p as re,q as Y,s,v as ue,R as O,x as ie,y as oe,z as ne,A as _,B as I,C as ce,D as ve,E as he,F as pe,O as de,G as ye,H as me,P as ge,I as fe,J as He,K as x}from"./app-DicGJuUL.js";const Re=["/","/cs/","/algorithm/","/web/","/algorithm/carl/","/algorithm/carl/day1.html","/algorithm/carl/day2.html","/algorithm/carl/day3.html","/algorithm/carl/day4.html","/algorithm/leetcode/","/404.html","/category/","/category/%E7%AE%97%E6%B3%95/","/tag/","/tag/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/","/article/","/star/","/timeline/"],Qe="SEARCH_PRO_QUERY_HISTORY",d=U(Qe,[]),ke=()=>{const{queryHistoryCount:t}=x,l=t>0;return{enabled:l,queryHistory:d,addQueryHistory:r=>{l&&(d.value.length<t?d.value=Array.from(new Set([r,...d.value])):d.value=Array.from(new Set([r,...d.value.slice(0,t-1)])))},removeQueryHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}},P=t=>Re[t.id]+("anchor"in t?`#${t.anchor}`:""),we="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:F}=x,y=U(we,[]),Ee=()=>{const t=F>0;return{enabled:t,resultHistory:y,addResultHistory:l=>{if(t){const r={link:P(l),display:l.display};"header"in l&&(r.header=l.header),y.value.length<F?y.value=[r,...y.value]:y.value=[r,...y.value.slice(0,F-1)]}},removeResultHistory:l=>{y.value=[...y.value.slice(0,l),...y.value.slice(l+1)]}}},xe=t=>{const l=ce(),r=M(),q=ve(),i=B(!1),f=he([]);return pe(()=>{const{search:Q,terminate:m}=de(),k=()=>{f.value=[],i.value=!1},H=He(c=>{const R=c.join(" "),{searchFilter:C=p=>p,splitWord:A,suggestionsFilter:T,...g}=l.value;i.value=!0,R?Q(c.join(" "),r.value,g).then(p=>C(p,R,r.value,q.value)).then(p=>{f.value=p,i.value=!1}).catch(p=>{console.error(p),k()}):k()},x.searchDelay-x.suggestDelay);Y([t,r],([c])=>H(c),{immediate:!0}),ye(()=>{m()})}),{searching:i,results:f}};var Ce=Z({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(t,{emit:l}){const r=ee(),q=M(),i=ae(se),{enabled:f,addQueryHistory:Q,queryHistory:m,removeQueryHistory:k}=ke(),{enabled:H,resultHistory:c,addResultHistory:R,removeResultHistory:C}=Ee(),A=f||H,T=te(t,"queries"),{results:g,searching:p}=xe(T),u=le({isQuery:!0,index:0}),v=B(0),h=B(0),$=L(()=>A&&(m.value.length>0||c.value.length>0)),S=L(()=>g.value.length>0),D=L(()=>g.value[v.value]||null),z=()=>{const{isQuery:e,index:a}=u;a===0?(u.isQuery=!e,u.index=e?c.value.length-1:m.value.length-1):u.index=a-1},G=()=>{const{isQuery:e,index:a}=u;a===(e?m.value.length-1:c.value.length-1)?(u.isQuery=!e,u.index=0):u.index=a+1},J=()=>{v.value=v.value>0?v.value-1:g.value.length-1,h.value=D.value.contents.length-1},K=()=>{v.value=v.value<g.value.length-1?v.value+1:0,h.value=0},V=()=>{h.value<D.value.contents.length-1?h.value+=1:K()},N=()=>{h.value>0?h.value-=1:J()},b=e=>e.map(a=>me(a)?a:s(a[0],a[1])),W=e=>{if(e.type==="customField"){const a=ge[e.index]||"$content",[o,E=""]=fe(a)?a[q.value].split("$content"):a.split("$content");return e.display.map(n=>s("div",b([o,...n,E])))}return e.display.map(a=>s("div",b(a)))},w=()=>{v.value=0,h.value=0,l("updateQuery",""),l("close")};return re("keydown",e=>{if(t.isFocusing){if(S.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const a=D.value.contents[h.value];Q(t.queries.join(" ")),R(a),r.push(P(a)),w()}}else if(H){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:a}=u;u.isQuery?(l("updateQuery",m.value[a]),e.preventDefault()):(r.push(c.value[a].link),w())}}}}),Y([v,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:t.queries.length?!S.value:!$.value}],id:"search-pro-results"},t.queries.length?p.value?s(ue,{hint:i.value.searching}):S.value?s("ul",{class:"search-pro-result-list"},g.value.map(({title:e,contents:a},o)=>{const E=v.value===o;return s("li",{class:["search-pro-result-list-item",{active:E}]},[s("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),a.map((n,X)=>{const j=E&&h.value===X;return s(O,{to:P(n),class:["search-pro-result-item",{active:j,"aria-selected":j}],onClick:()=>{Q(t.queries.join(" ")),R(n),w()}},()=>[n.type==="text"?null:s(n.type==="title"?ie:n.type==="heading"?oe:ne,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?s("div",{class:"content-header"},n.header):null,s("div",W(n))])])})])})):i.value.emptyResult:A?$.value?[f?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.queryHistory),m.value.map((e,a)=>s("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===a}],onClick:()=>{l("updateQuery",e)}},[s(_,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:o=>{o.preventDefault(),o.stopPropagation(),k(a)}})]))])):null,H?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,a)=>s(O,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===a}],onClick:()=>{w()}},()=>[s(_,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(o=>b(o)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:o=>{o.preventDefault(),o.stopPropagation(),C(a)}})]))])):null]:i.value.emptyHistory:i.value.emptyResult)}});export{Ce as default};
